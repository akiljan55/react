import request from '../request';

export function loginSuccess(state, response) {
  return state
    .deleteIn(['login', 'loading'])
    .deleteIn(['login', 'error'])
    .setIn(['login', 'token'], response);
}

export function loginFailure(state, error) {
  return state
    .deleteIn(['login', 'loading'])
    .deleteIn(['login', 'token'])
    .setIn(['login', 'error'], error);
}

export function login(state, username, password) {
  request('/login/')
    .data({username, password})
    .send()
    .then(this.actions.loginSuccess, this.actions.loginFailure);

  return state
    .deleteIn(['login', 'error'])
    .deleteIn(['login', 'token'])
    .setIn(['login', 'loading'], true);
}
